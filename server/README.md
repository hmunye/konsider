# Konsider REST API

## Project Structure

```
├── .env
├── .gitignore
├── .sqlx                               		# Query metadata for sqlx offline usage
├── Cargo.lock                     
├── Cargo.toml                          		# Manifest file for the project; specifies metadata and dependencies
├── README.md                       
├── config                          
│   ├── local.toml                      		# Local development configuration settings
│   └── production.toml                 		# Production environment configuration settings
├── docs                          
│   ├── database_design.md              
│   └── design_and_architecture.md
├── logs                                		# Directory for storing log files generated by the application during runtime
├── migrations                          		# Database migrations directory for managing schema changes over time
├── scripts                         
│   └── init_db.sh                      		# Bash script to initialize a PostgreSQL database instance using Docker
├── src                         
│   ├── api                         
│   │   ├── controllers                 		# Manages incoming HTTP requests and prepares outgoing responses
│   │   ├── middleware                  		# Contains middleware functions
│   │   ├── models                      		# Defines data structures that map to database tables
│   │   ├── repositories                		# Manages data persistence and interactions with the database
│   │   ├── routes                      		# Defines application routes and their handlers, mapping URLs to controllers
│   │   ├── services                    		# Contains business logic and service functions
│   │   └── utils
│   │       ├── cookie.rs               		# Handles the creation of cookies with customizable flags and security settings
│   │       ├── json_extractor.rs       		# Wrapper for axum's Json to extract and parse JSON data from requests
│   │       ├── jwt
│   │       │   ├── claims.rs           		# Defines the structure for JWT claims
│   │       │   ├── decode.rs           		# Function for decoding and validating JWT tokens
│   │       │   ├── generate.rs         		# Function for generating JWT tokens
│   │       │   ├── poll_database_worker.rs 	        # Background worker that periodically checks the database for valid tokens and updates token cache
│   │       │   ├── token_cache.rs                      # In-memory cache for storing active, valid JWT tokens
│   │       │   └── token_extractor.rs                  # Extracts JWT tokens from Cookie header in requests
│   │       └── mod.rs
│   ├── config.rs                       		# Code for loading and managing application configuration
│   ├── error.rs                        		# Defines server and client error types and handling logic
│   ├── lib.rs                     
│   ├── log.rs                          		# Configures and manages the application’s logging behavior
│   ├── main.rs                 
│   └── server.rs                       		# Sets up and runs the application server
└── tests
    └── api
        ├── auth
        ├── common.rs
        ├── health
        └── main.rs       
```

## Usage

### 1. **Prerequisites**

Before starting, ensure the following tools are installed:

- **Rust**: Install Rust and Cargo using the [rustup](https://www.rust-lang.org/tools/install) tool.
- **Docker**: Install Docker by following the instructions on [Get Docker](https://docs.docker.com/get-started/get-docker/).
- **sqlx-cli**: Install the [sqlx-cli](https://github.com/launchbadge/sqlx) tool using Cargo with the following command:

```bash
cargo install sqlx-cli --no-default-features --features postgres
```

### 2. **Clone the Repository**

```bash
git clone https://github.com/hmunye/konsider.git
```
```bash
cd konsider/server
```
